# 7장: 프록시와 안정적인 트래픽

---

## **프록시와 중간 서버**
- **프록시 서버의 역할**: 클라이언트와 오리진 서버 사이에서 메시지를 중계하며, 캐싱, 로드 밸런싱, 보안 강화 등의 기능을 수행.
- **포워드 프록시와 리버스 프록시**:
  - **포워드 프록시**: 클라이언트 요청을 중계하여 오리진 서버에 전달.
  - **리버스 프록시**: 클라이언트가 직접 오리진 서버에 접근하지 못하도록 하고, 요청을 대신 처리.

---

## **고가용성과 안정성**
- **가용성(Availability)**: 시스템이 정상적으로 서비스를 제공할 수 있는 비율.
- **고가용성(High Availability)**: 장애 발생 시에도 시스템이 지속적으로 작동할 수 있도록 설계.
  - 예: 99.9% 가용성은 연간 약 8.77시간의 다운타임 허용.

---

## **로드 밸런싱**
- **필요성**: 여러 서버에 트래픽을 분산하여 과부하를 방지하고 성능 및 가용성을 높임.
- **알고리즘**:
  - 최소 연결 알고리즘: 가장 적은 연결 수를 가진 서버로 트래픽 분배.
  - 가중치 기반 알고리즘: 서버 성능에 따라 가중치를 부여하여 트래픽 분배.

---

## **스케일링**
- **스케일 업(Scale Up)**: 기존 서버의 성능을 향상시키는 방식.
  - 장점: 설치와 구성이 간단하며 추가적인 네트워크 설정 불필요.
  - 단점: 성능 한계에 도달하면 더 이상 확장이 어려움.
- **스케일 아웃(Scale Out)**: 여러 대의 서버를 추가하여 트래픽을 분산 처리.
  - 장점: 확장성이 뛰어나며 장애 발생 시 유연한 대처 가능.
  - 단점: 초기 설정 및 관리 복잡, 네트워크 구성 필요.
- **오토스케일링(Auto Scaling)**:
  - 트래픽 변화에 따라 서버 자원을 자동으로 조정하여 효율적인 자원 사용 가능.
  - 클라우드 환경에서 주로 활용되며, 특정 시간대나 이벤트에 따른 트래픽 급증 문제 해결.

---

## **Nginx를 활용한 로드 밸런싱**
### **Nginx 개요**
- 웹 서버 및 리버스 프록시 역할을 수행하는 경량화된 소프트웨어.
- 주요 기능:
  - 포워드/리버스 프록시 설정
  - 로드 밸런싱
  - 보안 강화 (SSL/TLS 지원)

### **로드 밸런싱 설정**
1. **Nginx 설치 및 설정 파일 경로**:
   - 주요 설정 파일: `/etc/nginx/nginx.conf`
   - 로그 파일:
     - `access.log`: 요청 기록
     - `error.log`: 에러 로그

2. **백엔드 서버 그룹 정의**:
```
upstream backend {
server 10.10.10.2 weight=1;
server 10.10.10.3 weight=2;
server 10.10.10.4 backup;
}
```

3. **프록시 설정**:
```
server {
listen 80;
server_name localhost;
```

```
location / {
    proxy_pass http://backend;
}
```

- 요청을 `backend` 그룹으로 전달하며, 가중치(weight)와 백업 서버를 지정.

4. **로드 밸런싱 알고리즘**:
- 기본값: Round Robin(순차적 분배)
- 옵션:
  - `least_conn`: 최소 연결 수를 가진 서버로 분배.
  - `ip_hash`: 클라이언트 IP 기반으로 분배.

---

## **웹 서버와 웹 애플리케이션 서버**
### **웹 서버(Web Server)**
- 클라이언트 요청을 받아 정적 콘텐츠(HTML, 이미지 등)를 제공.
- 대표적인 웹 서버: Nginx, Apache, IIS.

### **웹 애플리케이션 서버(WAS)**
- 동적 콘텐츠를 처리하며 데이터베이스와 연동.
- 예: 사용자의 요청에 따라 실시간 데이터를 생성하여 반환.

---

## **업스트림/다운스트림**
- **업스트림(Upstream)**: 클라이언트 → 중간 서버 → 오리진 서버로의 트래픽 흐름.
- **다운스트림(Downstream)**: 오리진 서버 → 클라이언트로의 응답 흐름.

---

## **주요 개념 정리**
1. 스케일 업과 스케일 아웃은 각각의 장단점이 있으며, 상황에 따라 적절히 선택해야 함.
2. Nginx는 로드 밸런싱과 프록시 기능을 제공하며 다양한 알고리즘을 지원함.
3. 웹 서버는 정적 콘텐츠 제공, 웹 애플리케이션 서버는 동적 콘텐츠 처리를 담당함.

---